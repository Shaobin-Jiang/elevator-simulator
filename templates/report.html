<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Report</title>
        <style>
            table {
                width: 100%;
                border-collapse: collapse;
                margin: 20px 0;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                font-size: 14px;
                box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
                border-radius: 8px;
                overflow: hidden;
                background-color: white;
            }

            thead {
                background-color: #3498db;
                color: white;
            }

            thead th {
                padding: 16px 15px;
                text-align: left;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                font-size: 13px;
            }

            tbody tr {
                border-bottom: 1px solid #e1e1e1;
                transition: background-color 0.2s ease;
            }

            tbody tr:last-child {
                border-bottom: none;
            }

            tbody tr:hover {
                background-color: #f8f9fa;
            }

            tbody td {
                padding: 14px 15px;
                color: #333;
                text-align: center;
            }

            tbody tr:nth-child(even) {
                background-color: #f8f9fa;
            }

            tbody tr:nth-child(even):hover {
                background-color: #e9ecef;
            }
        </style>
    </head>
    <body>
        <h2>Metrics Report</h2>
        <p>
            For items in the form of "a / b", a is the actual performance metric of the algorithm and b is that of the
            example program provided in the elevator_saga package which uses a SCAN algorithm.
        </p>

        <script>
            let baseline;

            fetch(`/metrics?algorithm=baseline`)
                .then((response) => response.json())
                .then(function (data) {
                    baseline = data;
                    fetch(`/metrics`)
                        .then((response) => response.json())
                        .then(function (report_json) {
                            let table = document.createElement('table');
                            let innerHTML = '<thead><tr><th></th>';

                            for (let item in report_json[Object.keys(report_json)[0]]) {
                                innerHTML += `<th>${item}</th>`;
                            }
                            innerHTML += `</tr></thead><tbody>`;

                            for (let traffic in report_json) {
                                let metrics = report_json[traffic];
                                innerHTML += `<tr><td>${traffic}</td>`;

                                for (let item in metrics) {
                                    if (item == 'total_passengers') {
                                        innerHTML += `<td>${metrics[item]}</td>`;
                                        continue;
                                    }
                                    b = Math.round(baseline[traffic][item] * 100) / 100;
                                    p = Math.round(metrics[item] * 100) / 100;
                                    let color;
                                    if (item == 'completed_passengers') {
                                        color = p >= b ? 'green' : 'red';
                                    } else {
                                        color = p <= b ? 'green' : 'red';
                                    }
                                    innerHTML += `<td><span style="color: ${color};">${p}</span> / ${b}</td>`;
                                }
                                innerHTML += '</tr>';
                            }

                            innerHTML += '</tbody>';
                            table.innerHTML = innerHTML;

                            document.body.appendChild(table);
                        });
                });
        </script>
    </body>
</html>
